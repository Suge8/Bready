# Bready 音频捕获说明

## 🎯 概述
Bready 使用 **Electron 原生音频架构**，完全解决了编译复杂性问题，实现真正的开箱即用体验。

### ✨ **架构亮点**

🚀 **零编译需求** - 告别 Swift 编译和依赖地狱  
🎯 **纯 Electron 实现** - 使用原生 API，稳定可靠  
🔄 **智能双模式** - 系统音频 + 麦克风，无缝切换  
📱 **跨进程协作** - 主进程协调，渲染进程执行  

## 🏗️ 技术架构

### 📊 **进程分工**

| 进程类型 | 职责 | 技术实现 |
|---------|------|----------|
| **主进程** | 权限检查、状态管理、数据转发 | electronAudioCapture 协调器 |
| **渲染进程** | 音频捕获、数据处理、格式转换 | Web Audio API + desktopCapturer |

### 🔄 **双模式设计**

#### 🎧 系统音频模式
- **用途**: 捕获扬声器播放的所有声音
- **技术**: `desktopCapturer` + `getUserMedia`
- **场景**: 在线面试、视频会议
- **权限**: 屏幕录制权限

#### 🗣️ 麦克风模式  
- **用途**: 捕获麦克风输入的声音
- **技术**: 标准 `getUserMedia` API
- **场景**: 直接对话、练习模式
- **权限**: 麦克风权限

## 🎮 使用体验

### 🚀 **开发者体验**
```bash
# 一行命令，立即开始
npm run dev

# 无需额外安装任何工具
# 无需编译任何依赖
# 无需配置复杂环境
```

### 👤 **用户体验**
1. 🎯 **自动检测**: 应用自动检测最佳音频模式
2. 🔄 **一键切换**: 右上角轻松切换音频模式
3. 📊 **实时反馈**: 清晰显示当前音频状态
4. 🛡️ **优雅降级**: 系统音频失败时自动切换到麦克风

## 🔧 技术细节

### 📡 **IPC 通信流程**
```
主进程发起 → 渲染进程捕获 → 数据回传 → AI处理
    ↓              ↓           ↓         ↓
协调管理        实际采集     格式转换   语音识别
```

### 🎵 **音频处理管道**
1. **音频源获取**: desktopCapturer 或 getUserMedia
2. **实时处理**: Web Audio API ScriptProcessorNode  
3. **格式转换**: Float32 → PCM 16-bit
4. **数据传输**: IPC 通道发送到主进程
5. **AI集成**: 直接发送给 Gemini API

## 💡 架构优势

### 🎯 **解决的痛点**
- ❌ **编译复杂**: Swift 工具链、SDK 版本问题
- ❌ **依赖地狱**: 外部工具安装失败  
- ❌ **环境差异**: 不同开发环境的兼容性
- ❌ **维护成本**: 第三方工具的更新维护

### ✅ **新架构优势**
- ✅ **开箱即用**: 零配置，立即可用
- ✅ **稳定可靠**: 基于成熟的 Electron API
- ✅ **跨平台**: Windows、macOS、Linux 统一
- ✅ **易维护**: 纯 JavaScript/TypeScript 实现

## 🔍 故障排除

### 常见问题
1. **权限问题**: 应用会自动引导权限设置
2. **模式切换**: 右上角下拉菜单手动切换
3. **音频质量**: 自动采用最佳音频参数
4. **兼容性**: 支持所有现代 Electron 版本

### 调试信息
```bash
# 查看音频状态
console.log(rendererAudioCapture.getStatus())

# 检查权限
# 系统偏好设置 > 安全性与隐私
```

---

## 🎉 总结

**Bready 音频架构从复杂回归简单，从依赖走向自主**

- 🏁 **过去**: Swift编译 + SystemAudioDump + 复杂配置
- 🚀 **现在**: 纯Electron + 原生API + 零配置

**这才是 Electron 应用应有的样子！** 🎯